#include "hanio.h"
#include "extendio.h"
#include "keydef.h"

void main(void)
{
   pulldown_menu_struct menu_data =
   {
      10, 1,        /* 주메뉴의 갯수는 10개이고 최초에는 1번 메뉴가 선택된다.*/
      { 1, 7, 15, 21, 27, 33, 39, 45, 51, 61 },      /* 주메뉴 10개의 x 좌표 */
      { " <한> ", " 서류철 ", " 편집 ", " 입력 ", " 찾기 ",
        " 조판 ", " 출력 ", " 화면 ", " 특수기능 ", " 선택사항 ",
      },
      /* 이 부분에서부터 부메뉴 10 개가 정의된다. */
      { /* 0 번 메뉴(<한>) */
        { 6, 0, 1, 1,                      /* (1, 1)에 6개짜리 부메뉴를 구성 */
          { " <한> 이란    ",
            " 도움말    F1 ",
            " 자판배열 @F1 ",
            " 달력         ",
            " 계산기       ",
            " 전화번호부   ",
          }
        },
        /* 1 번 메뉴(서류철) */
        { 7, 0, 7, 1,                      /* (7, 1)에 7개짜리 부메뉴를 구성 */
          { "새 글       @N",
            "불러오기    @O",
            "저장하기    @S",
            "새이름으로  @V",
            "경로바꾸기    ",
            "도스명령어 @F0",
            "끝          @X",
          }
        },
        /* 2 번 메뉴(편집) */
        { 7, 0, 15, 1,                    /* (15, 1)에 7개짜리 부메뉴를 구성 */
          { " 원래대로   ^Z ",
            " 오려두기   ^X ",
            " 복사       ^C ",
            " 붙이기     ^V ",
            " 지우기     ^E ",
            " 블럭 읽기 ^KR ",
            " 블럭 쓰기 ^KW ",
          }
        },
        /* 3 번 메뉴(입력) */
        { 7, 0, 21, 1,                    /* (21, 1)에 7개짜리 부메뉴를 구성 */
          { " 문자      @F2 ",
            " 글자모양   @L ",
            " 문단모양   @T ",
            " 선그리기   @D ",
            " 상용구실행 @I ",
            " 매크로정의 @B ",
            " 여러번실행 @Z ",
          }
        },
        /* 4 번 메뉴(찾기) */
        { 6, 0, 27, 1,                    /* (27, 1)에 6개짜리 부메뉴를 구성 */
          { " 찾기     ^QF ",
            " 바꾸기   ^GA ",
            " 행으로   ^QG ",
            " 페이지    @G ",
            " 조판문자  ^G ",
            " 문자종류 ^QS ",
          }
        },
        /* 5 번 메뉴(조판) */
        { 7, 0, 33, 1,                    /* (33, 1)에 7개짜리 부메뉴를 구성 */
          { " 머리말      ^NH ",
            " 꼬리말      ^NF ",
            " 각주        ^NN ",
            " 그림        ^NI ",
            " 특수 문자   ^NS ",
            " 페이지 정돈 ^NP ",
            " 페이지 나눔  ^J ",
          }
        },
        /* 6 번 메뉴(출력) */
        { 2, 0, 39, 1,                    /* (39, 1)에 2개짜리 부메뉴를 구성 */
          { " 인쇄        @P ",
            " 프린터 설정 ^P ",
          }
        },
        /* 7 번 메뉴(화면) */
        { 7, 0, 45, 1,                    /* (45, 1)에 7개짜리 부메뉴를 구성 */
          { " 수직나누기 ^WV ",
            " 수평나누기 ^WH ",
            " 화면닫기   ^WC ",
            " 다른화면    @W ",
            " 모양바꾸기 ^WX ",
            " 크기조절   ^WS ",
            " 화면확대   ^WZ ",
          }
        },
        /* 8 번 메뉴(특수기능) */
        { 3, 0, 51, 1,                    /* (51, 1)에 3개짜리 부메뉴를 구성 */
          { " 목차만들기 ",
            " 메일 머지  ",
            " 소 트      ",
          }
        },
        /* 9 번 메뉴(선택사항) */
        { 8, 0, 61, 1,                    /* (61, 1)에 8개짜리 부메뉴를 구성 */
          { " 표식 보이기   ",
            " 눈금 보이기   ",
            "  \x14  보이기    ",
            " 저장 간격  30 ",
            " 탭설정        ",
            " 배경색        ",
            " 시  계        ",
            " 정돈 반자동   ",
          }
        },
      }
   };
   char key;                                           /* 마지막에 눌려진 키 */
   int  main_menu, sub_menu;                       /* 선택된 주메뉴와 부메뉴 */

   if(init_han() != OK_HAN) exit(1);

   aputs_han(33, 19, "메뉴를  선택하세요", FONT_SHADE);
   while(1)
   {
      /* 이 부분에서 풀다운 메뉴가 구성된다. */
      key = pulldown_han(&menu_data);

      if(key == ESC) break;                  /* <Esc> 키를 눌러도 끝이 난다. */
      /* 선택된 주메뉴는 main_menu 에, 부메뉴는 sub_menu에 저장한다. */
      main_menu = menu_data.current;
      sub_menu  = menu_data.sub_menu[main_menu].current;

      /* 이 부분에서 '끝' 이외의 메뉴도 함께 처리해 주면 된다. */
      switch(main_menu)
      {
         case 1 : switch(sub_menu)
                  {
                     /* 주메뉴는 1, 부메뉴는 0 ('끝' 메뉴)이면 끝을 낸다.*/
                     case 6 : close_han();
                              exit();
                  }
      /* case 2 : switch(sub_menu)
           :
      */
      }
      nprintf_han(20, 20, 40, "<%s> 메뉴를 선택하셨습니다",
                  menu_data.sub_menu[main_menu].string[sub_menu]);
   }

   close_han();
}
